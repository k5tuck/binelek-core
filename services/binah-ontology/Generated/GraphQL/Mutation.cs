// <auto-generated />
// Generated from SupplyChainOntology vv1.0.0

using System;
using System.Threading;
using System.Threading.Tasks;
using HotChocolate;
using HotChocolate.Types;
using Acme.SupplyChain.Entities;
using Acme.SupplyChain.GraphQL.Types;
using Acme.SupplyChain.Repositories;

namespace Acme.SupplyChain.GraphQL
{
    /// <summary>
    /// GraphQL Mutation root type
    /// </summary>
    public class Mutation
    {
        /// <summary>Create a new Order</summary>
        public async Task<Order> CreateOrderAsync(
            CreateOrderInput input,
            [Service] IOrderRepository repository,
            CancellationToken cancellationToken)
        {
            var entity = new Order
            {
                OrderNumber = input.OrderNumber,
                CustomerId = input.CustomerId,
                TotalAmount = input.TotalAmount,
                Status = input.Status,
                OrderDate = input.OrderDate,
            };

            return await repository.CreateAsync(entity, cancellationToken);
        }

        /// <summary>Update an existing Order</summary>
        public async Task<Order> UpdateOrderAsync(
            Guid id,
            UpdateOrderInput input,
            [Service] IOrderRepository repository,
            CancellationToken cancellationToken)
        {
            var entity = await repository.GetByIdAsync(id, cancellationToken);
            if (entity == null)
                throw new GraphQLException($"Order with ID {id} not found.");

            if (input.OrderNumber != null)
                entity.OrderNumber = input.OrderNumber!;
            if (input.CustomerId != null)
                entity.CustomerId = input.CustomerId!;
            if (input.TotalAmount != null)
                entity.TotalAmount = input.TotalAmount!;
            if (input.Status != null)
                entity.Status = input.Status!;
            if (input.OrderDate != null)
                entity.OrderDate = input.OrderDate!;

            return await repository.UpdateAsync(entity, cancellationToken);
        }

        /// <summary>Delete a Order</summary>
        public async Task<bool> DeleteOrderAsync(
            Guid id,
            [Service] IOrderRepository repository,
            CancellationToken cancellationToken)
        {
            return await repository.DeleteAsync(id, cancellationToken);
        }

        /// <summary>Create a new Customer</summary>
        public async Task<Customer> CreateCustomerAsync(
            CreateCustomerInput input,
            [Service] ICustomerRepository repository,
            CancellationToken cancellationToken)
        {
            var entity = new Customer
            {
                CompanyName = input.CompanyName,
                Email = input.Email,
                Phone = input.Phone,
                Address = input.Address,
            };

            return await repository.CreateAsync(entity, cancellationToken);
        }

        /// <summary>Update an existing Customer</summary>
        public async Task<Customer> UpdateCustomerAsync(
            Guid id,
            UpdateCustomerInput input,
            [Service] ICustomerRepository repository,
            CancellationToken cancellationToken)
        {
            var entity = await repository.GetByIdAsync(id, cancellationToken);
            if (entity == null)
                throw new GraphQLException($"Customer with ID {id} not found.");

            if (input.CompanyName != null)
                entity.CompanyName = input.CompanyName!;
            if (input.Email != null)
                entity.Email = input.Email!;
            if (input.Phone != null)
                entity.Phone = input.Phone;
            if (input.Address != null)
                entity.Address = input.Address!;

            return await repository.UpdateAsync(entity, cancellationToken);
        }

        /// <summary>Delete a Customer</summary>
        public async Task<bool> DeleteCustomerAsync(
            Guid id,
            [Service] ICustomerRepository repository,
            CancellationToken cancellationToken)
        {
            return await repository.DeleteAsync(id, cancellationToken);
        }

        /// <summary>Create a new Product</summary>
        public async Task<Product> CreateProductAsync(
            CreateProductInput input,
            [Service] IProductRepository repository,
            CancellationToken cancellationToken)
        {
            var entity = new Product
            {
                SKU = input.SKU,
                Name = input.Name,
                Description = input.Description,
                UnitPrice = input.UnitPrice,
                StockQuantity = input.StockQuantity,
            };

            return await repository.CreateAsync(entity, cancellationToken);
        }

        /// <summary>Update an existing Product</summary>
        public async Task<Product> UpdateProductAsync(
            Guid id,
            UpdateProductInput input,
            [Service] IProductRepository repository,
            CancellationToken cancellationToken)
        {
            var entity = await repository.GetByIdAsync(id, cancellationToken);
            if (entity == null)
                throw new GraphQLException($"Product with ID {id} not found.");

            if (input.SKU != null)
                entity.SKU = input.SKU!;
            if (input.Name != null)
                entity.Name = input.Name!;
            if (input.Description != null)
                entity.Description = input.Description;
            if (input.UnitPrice != null)
                entity.UnitPrice = input.UnitPrice!;
            if (input.StockQuantity != null)
                entity.StockQuantity = input.StockQuantity!;

            return await repository.UpdateAsync(entity, cancellationToken);
        }

        /// <summary>Delete a Product</summary>
        public async Task<bool> DeleteProductAsync(
            Guid id,
            [Service] IProductRepository repository,
            CancellationToken cancellationToken)
        {
            return await repository.DeleteAsync(id, cancellationToken);
        }

    }
}
